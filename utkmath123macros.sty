%% Copyright 2025 Bernardo Ameneyro
%
% This work may be distributed and/or modified under the conditions of the LaTeX Project Public License.
% The latest version of this license is in
%   https://www.latex-project.org/lppl.txt
% and version 1.3c or later is part of all distributions of LaTeX version 2008 or later.
%
% This work has the LPPL maintenance status `maintained'.
%
% The Current Maintainer of this work is Bernardo Ameneyro.
%
% This work consists of the file(s): utkmath123macros.sty, utkmath123exam.cls, utkmath123la.cls, utkmath123ra.cls

\ProvidesPackage{utkmath123macros}[2025/01/31 This package provides useful commands to create assignments for the math 123 course and possibly others.]


%--------------- Required Packages ------------------
\RequirePackage{amsmath,amssymb}
\RequirePackage{array}
\RequirePackage{tikz}
\RequirePackage{pgfplots}
\RequirePackage{enumitem}
\RequirePackage{mdframed}
\RequirePackage{wasysym}
\RequirePackage{exsheets}

%--------------- Questions and Solutions Style ------------------
\definecolor{solution-color}{RGB}{0,0,255}
\definecolor{rubric-color}{RGB}{255,0,0}

\DeclareInstance{exsheets-heading}{exam-problems}{default}{
  runin = true,
  points-pre-code = [,
  points-post-code = ]\space,
  join =
  {
    main[r,vc]number[l,vc](0pt,0pt);
    main[r,vc]points[l,vc](.333em,0pt)
  }
}

\SetupExSheets{counter-format = qu.}
\SetupExSheets[question]{headings = exam-problems}
\SetupExSheets[solution]{headings = empty, pre-body-hook = {\color{solution-color}}}
\SetupExSheets[points]{name = pt/s}

% ------------ Rubric Notes ------------
\newcommand{\rubric}[1]{\PrintSolutionsT{\color{rubric-color}#1}}
\newcommand{\mrubric}[1]{\PrintSolutionsT{\reversemarginpar\marginpar[\raggedleft\color{rubric-color}#1]{\raggedright\color{rubric-color}#1}}}

% --------- Multiple Choice and Select All ---------
\newcommand{\choice}{{\Large\(\Circle\)}}
\newcommand{\correctchoice}{%
  \PrintSolutionsTF{{\color{solution-color}\Large\(\CIRCLE\)}}{\choice}%
}

\newcommand{\selectall}{{\Large\(\Square\)}}
\newcommand{\correctselectall}{%
  \PrintSolutionsTF{{\color{solution-color}\Large\(\blacksquare\)}}{\selectall}%
}

% --------- Answer Box ---------
\newcommand{\AnswerBox}[3]{%
  \mdframed
  \begin{centering}
  #1\\
  \PrintSolutionsTF{\vspace{0.1in} \color{solution-color}#3\\ \vspace{0.1in}}{\vspace{#2}}
  \end{centering}
  \endmdframed
}
\newcommand{\AnswerBoxLeft}[2]{%
  \mdframed
  \vspace{0.16in}
  #1 \PrintSolutionsTF{\color{solution-color}#2}{}
  \vspace{0.16in}
  \endmdframed
}

% --------- Instructions ---------
\newcommand{\TrueFalseInstructions}{Determine if the statement is True or False and fill in your answer choice completely.}
\newcommand{\MultipleChoiceInstructions}{Multiple choice, fill in your choice completely.}
\newcommand{\SelectAllInstructions}{Select all that apply and fill in your choices completely.}
\newcommand{\FormulaInstructions}{\textit{Select all formulas that are needed, fill in the formula(s) with the given values, and then solve.}}
\newcommand{\RoundUnitsInstructions}{\textit{Round the final answer to 2 decimal places and include units with the final answer.}}
\newcommand{\TVMInstructions}{\textit{Fill in the information you would enter into the TVM solver to solve this problem. Write ``alpha'' in the box corresponding to the variable you are solving for. \textbf{Do NOT solve.}}}

% --------- Formulas ---------
\newcommand{\Unit1Formulas}{
  \mdframed
  \vspace{0.1in}
  \begin{tasks}(3)
    \task[\textbf{A. }] \ \(I=Prt\)
    \task[\textbf{B. }] \ \(A=P(1+rt)\)
    \task[\textbf{C. }] \ \(A=P(1+i)^n\)
    \task[\textbf{D. }] \ \(r_{\text{eff}}=\left(1+\dfrac{r}{m}\right)^m - 1\)
    \task[\textbf{E. }] \ \(r_{\text{eff}} = \left(\dfrac{A}{P}\right)^{1/t} - 1\)
    \task[\textbf{F. }] \ \(S = R\left[\dfrac{(1+i)^n-1}{i} \right]\)
    \task[\textbf{G. }] \ \(P = R\left[\dfrac{1-(1+i)^{-n}}{i} \right]\)
    \task[] \ \(i=\dfrac{r}{m}\), \ \(n=mt\)
  \end{tasks}
  \vspace{0.02in}
  \endmdframed
}

% --------- TVM Solver Table ---------
\newcommand{\TVMTable}[6]{
  \renewcommand{\arraystretch}{1.2}
  \begin{tabular}{|l|p{4.5cm}|l|l|p{4.5cm}|}
    \hline
    \begin{tabular}[c]{@{}l@{}}N =\\ \textit{(Periods)}\end{tabular}
    & \PrintSolutionsT{\color{solution-color}#1}
    & \multirow{3}{*}{}
    & \begin{tabular}[c]{@{}l@{}}PMT = \\ \textit{(Payment)}\end{tabular}
    & \PrintSolutionsT{\color{solution-color}#2}
    \\ \cline{1-2} \cline{4-5}
    \begin{tabular}[c]{@{}l@{}}I\% = \\ \textit{(Annual Rate)}\end{tabular}
    & \PrintSolutionsT{\color{solution-color}#3}
    &
    & \begin{tabular}[c]{@{}l@{}}FV = \\ \textit{(Future Value)}\end{tabular}
    & \PrintSolutionsT{\color{solution-color}#4}
    \\ \cline{1-2} \cline{4-5}
    \begin{tabular}[c]{@{}l@{}}PV = \\ \textit{(Present Value)}\end{tabular}
    & \PrintSolutionsT{\color{solution-color}#5}
    &
    & \begin{tabular}[c]{@{}l@{}}P/Y and C/Y = \\ \textit{(compounding)}\end{tabular}
    & \PrintSolutionsT{\color{solution-color}#6}
    \\ \hline
  \end{tabular}
  \renewcommand{\arraystretch}{1}
}

% --------- Augmented Matrix ---------
\newenvironment{amatrix}[2]{%
  \left[%
    \begin{array}{@{}*{#1}{c}|*{#2}{c}@{}}
}{%
    \end{array}%
  \right]
}
\newcommand*\circled[1]{%
  \tikz[baseline=(char.base)]{\node[shape=circle, draw, inner sep=2pt] (char) {#1};}
}
\newcommand{\circledIF}[1]{\PrintSolutionsTF{\color{solution-color}\circled{#1}}{#1}}
\newenvironment{tableau}[1]{%
    \begin{array}{@{}*{#1}{c}|{c}@{}}
}{%
    \end{array}%
}

% --------- Graphing Environment ---------
\newenvironment{bgraph}{%
  \begin{tikzpicture}
    \begin{axis}[%
      xmin = -7.5, xmax = 7.5, ymin = -7.5, ymax = 7.5,
      domain = -7.5:7.5, restrict y to domain = -7.5:7.5,
      clip = false,
      xtick = {-8,...,8}, xticklabels = \empty,
      ytick = {-8,...,8}, yticklabels = \empty,
      axis x line = middle, axis y line = middle,
      grid = major, xlabel = {\(x\)}, ylabel = {\(y\)},
      xlabel style = {at = (current axis.right of origin), anchor = west},
      ylabel style = {at = (current axis.above origin), anchor = south},
      cycle list name = exotic, no marks, line width = 1pt,
      width = \textwidth, height = \textwidth
      ]
}{%
    \end{axis}
  \end{tikzpicture}
}

\newenvironment{sgraph}{%
  \begin{tikzpicture}
    \begin{axis}[
      xmin = -4.5, xmax = 4.5, ymin = -4.5, ymax = 4.5,
      domain = -4.5:4.5, restrict y to domain = -4.5:4.5,
      clip = false,
      xtick = {-5,...,5}, xticklabels = \empty,
      ytick = {-5,...,5}, yticklabels = \empty,
      axis x line = middle, axis y line = middle,
      grid = major, xlabel = {\(x\)}, ylabel = {\(y\)},
      xlabel style = {at = (current axis.right of origin), anchor = west},
      ylabel style = {at = (current axis.above origin), anchor = south},
      cycle list name = exotic, no marks, line width = 1pt,
      width = 1.8in, height = 1.8in
      ]
}{%
    \end{axis}
  \end{tikzpicture}
}

\newcommand{\intercepts}[4]{%
  \begin{tabular}{ | >{\raggedleft\arraybackslash}m{0.7in} | >{\centering\arraybackslash}m{1.5in} | >{\centering\arraybackslash}m{1.5in} | }
    \hline
    & & \\
    & \textbf{\(x\)-intercept} & \textbf{\(y\)-intercept} \\\hline
    & & \\
    \textbf{Line 1} & \PrintSolutionsT{\color{solution-color}\(#1\)} & \PrintSolutionsT{\color{solution-color}\(#2\)} \\
    & & \\\hline
    & & \\
    \textbf{Line 2} & \PrintSolutionsT{\color{solution-color}\(#3\)} & \PrintSolutionsT{\color{solution-color}\(#4\)} \\
    & & \\\hline
  \end{tabular}
}
