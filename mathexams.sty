\ProvidesPackage{mathexams}[2024/10/03 This package provides a format and useful commands to create exams for an undergraduate math course.]


%--------------- Required Packages ------------------
\RequirePackage{exsheets}
\RequirePackage{fancyhdr}
\RequirePackage{geometry}
\RequirePackage{amsmath,amssymb}
\RequirePackage{wasysym}
\RequirePackage{mdframed}
\RequirePackage{tikz}
\RequirePackage{pgfplots}
\RequirePackage{array}


%--------------- Exam Information ------------------
\newcommand{\GetCourse}{Math 000}
\newcommand{\GetTerm}{Fall 2024}
\newcommand{\GetExamUnit}{Unit 0}
\newcommand{\GetExamLength}{50 minutes}
\newcommand{\GetVersionID}{A}

\newcommand{\SetCourse}[1]{\renewcommand{\GetCourse}{#1}}
\newcommand{\SetTerm}[1]{\renewcommand{\GetTerm}{#1}}
\newcommand{\SetExamUnit}[1]{\renewcommand{\GetExamUnit}{#1}}
\newcommand{\SetExamLength}[1]{\renewcommand{\GetExamLength}{#1}}
\newcommand{\SetVersionID}[1]{\renewcommand{\GetVersionID}{#1}}

\definecolor{solution-color}{RGB}{0,0,255}
\definecolor{rubric-color}{RGB}{255,0,0}

%--------------- Headers and Page Style ------------------
\geometry{
  letterpaper,
  inner = 0.75in,
  outer = 0.5in,
  top = 1.0in,
  marginparwidth = 0.75in,
  textwidth = 7.25in,
  textheight = 9.2in
}

\fancypagestyle{exam-page-style}{
  \if@twoside
    \fancyhead[LE]{{\sc \GetCourse \ \GetTerm}}
    \fancyhead[CE]{{\sc \GetExamUnit \ Exam}}
    \fancyhead[RE]{{\sc Version \GetVersionID}}
    \fancyhead[LO]{{\sc Name:}}
  \else
    \fancyhead[L]{{\sc Name:}}
  \fi
}

\fancypagestyle{cover-page-style}{
  \fancyhead[L]{\textsc{Name:} \underline{\hspace{2.2in}}}
  \fancyhead[C]{\hfil\textsc{Email:} \underline{\hspace{1.5in}}@school.domain.edu}
  \fancyhead[R]{Section: \underline{\hspace{.5in}}}
  \renewcommand{\headrulewidth}{0pt} % removes horizontal header line
}


%--------------- Questions and Solutions Style ------------------
\DeclareInstance{exsheets-heading}{exam-problems}{default}{
  runin = true,
  points-pre-code = [,
  points-post-code = ]\space,
  join =
  {
    main[r,vc]number[l,vc](0pt,0pt);
    main[r,vc]points[l,vc](.333em,0pt)
  }
}

\SetupExSheets{%
  counter-format = qu.%
}

\SetupExSheets[question]{%
  headings = exam-problems%
}

\SetupExSheets[solution]{%
  headings = empty,%
  pre-body-hook = {\color{solution-color}}%
}

\SetupExSheets[points]{%
  name = pt/s%
}

% ------------ Rubric Notes ------------
\newcommand{\rubric}[1]{\color{rubric-color}#1}
\newcommand{\mrubric}[1]{\reversemarginpar\marginpar[\raggedleft\color{rubric-color}#1]{\raggedright\color{rubric-color}#1}}

% --------- Multiple Choice and Select All ---------
\newcommand{\choice}{{\Large\(\Circle\)}}
\newcommand{\correctchoice}{%
  \PrintSolutionsTF{{\color{solution-color}\Large\(\CIRCLE\)}}{\choice}%
}

\newcommand{\selectall}{{\Large\(\Square\)}}
\newcommand{\correctselectall}{%
  \PrintSolutionsTF{{\color{solution-color}\Large\(\blacksquare\)}}{\selectall}%
}

% --------- Answer Box ---------
\newcommand{\AnswerBox}[3]{%
  \mdframed
  \begin{centering}
  #1\\
  \PrintSolutionsTF{\vspace{0.1in} \color{solution-color}#3\\ \vspace{0.1in}}{\vspace{#2}}
  \end{centering}
  \endmdframed
}
\newcommand{\AnswerBoxLeft}[2]{%
  \mdframed
  \vspace{0.16in}
  #1 \PrintSolutionsTF{\color{solution-color}#2}{}
  \vspace{0.16in}
  \endmdframed
}

% --------- Instructions ---------
\newcommand{\tfinstructions}{Determine if the statement is True or False and fill in your answer choice completely.}
\newcommand{\mcinstructions}{Multiple choice, fill in your choice completely.}
\newcommand{\sainstructions}{Select all that apply and fill in your choices completely.}

% --------- Augmented Matrix ---------
\newenvironment{amatrix}[2]{%
  \left[%
    \begin{array}{@{}*{#1}{c}|*{#2}{c}@{}}
}{%
    \end{array}%
  \right]
}
\newcommand*\circled[1]{%
  \tikz[baseline=(char.base)]{\node[shape=circle, draw, inner sep=2pt] (char) {#1};}
}

