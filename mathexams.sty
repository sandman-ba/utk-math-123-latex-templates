\ProvidesPackage{mathexams}[2024/10/03 This package provides a format and useful commands to create exams for an undergraduate math course.]


%--------------- Required Packages ------------------
\RequirePackage{exsheets}
\RequirePackage{fancyhdr}


%--------------- Exam Information ------------------
\newcommand{\GetCourse}{Math 000}
\newcommand{\GetTerm}{Fall 2024}
\newcommand{\GetExamUnit}{Unit 0}
\newcommand{\GetExamLength}{50 minutes}
\newcommand{\GetNumberOfVersions}{2}
\newcommand{\GetVersion}{1}

\newcommand{\SetCourse}[1]{\renewcommand{\GetCourse}{#1}}
\newcommand{\SetTerm}[1]{\renewcommand{\GetTerm}{#1}}
\newcommand{\SetExamUnit}[1]{\renewcommand{\GetExamUnit}{#1}}
\newcommand{\SetExamLength}[1]{\renewcommand{\GetExamLength}{#1}}
\newcommand{\SetNumberOfVersions}[1]{\renewcommand{\GetNumberOfVersions}{#1}}
\newcommand{\SetVersion}[1]{\renewcommand{\GetVersion}{#1}}

\SetVariations{\GetNumberOfVersions}
\variant{\GetVersion}


%--------------- Headers and Page Style ------------------
\pagestyle{fancy}

\if @twoside
  \fancyhead[LE]{{\sc \GetCourse \ \GetTerm}}
  \fancyhead[CE]{{\sc \GetExamUnit \ Exam}}
  \fancyhead[RE]{{\sc Version \vary{A}{B}{C}{D}}}
  \fancyhead[LO]{{\sc Name:}}
\else
  \fancyhead[L]{{\sc Name:}}
\fi

\fancypagestyle{cover-page-style}
{
  \fancyhead[L]{\textsc{Name:} \underline{\hspace{2.2in}}}
  \fancyhead[C]{\hfil\textsc{Email:} \underline{\hspace{1.5in}}@school.domain.edu}
  \fancyhead[R]{Section: \underline{\hspace{.5in}}}
  \renewcommand{\headrulewidth}{0pt} % removes horizontal header line
}


%--------------- Questions and Solutions Style ------------------
\DeclareInstance{exsheets-heading}{runin-nr-wp}{default}{
  runin = true,
  points-pre-code = [,
  points-post-code = ]\space,
  join =
  {
    main[r,vc]number[l,vc](0pt,0pt);
    main[r,vc]points[l,vc](.333em,0pt)
  }
}

\SetupExSheets{%
  counter-format = qu.,%
  headings = runin-nr-wp%
}


